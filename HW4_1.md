-   [Clustering and PCA](#clustering-and-pca)

### Clustering and PCA

#### Clustering model

we first center and scale the data

##### distinguishing colors

To distinguish color, we first cluster the dataset into two parts, then
we run k-means with 2 clusters and 25 starts, and I create plots to show
different clusters’ color and other variables.

![](HW4_1_files/figure-markdown_strict/plot%20for%20pH%20&%20density-1.png)![](HW4_1_files/figure-markdown_strict/plot%20for%20pH%20&%20density-2.png)![](HW4_1_files/figure-markdown_strict/plot%20for%20pH%20&%20density-3.png)
we can clearly see that cluster 1 is almost white and cluster 2 is
almost red, no matter what variable is on the x-axis.

then we use kmeans++ method, and get the plot

    ##        fixed.acidity     volatile.acidity          citric.acid 
    ##            8.2895922            0.5319416            0.2695435 
    ##       residual.sugar            chlorides  free.sulfur.dioxide 
    ##            2.6342666            0.0883238           15.7647596 
    ## total.sulfur.dioxide              density                   pH 
    ##           48.6396835            0.9967404            3.3097200 
    ##            sulphates              alcohol 
    ##            0.6567194           10.4015216

![](HW4_1_files/figure-markdown_strict/kpp%20plots-1.png)![](HW4_1_files/figure-markdown_strict/kpp%20plots-2.png)![](HW4_1_files/figure-markdown_strict/kpp%20plots-3.png)
we also try hierarchical clustering, but the size of cluster is not very
balanced, so we don’t include too much details for this methods. I just
show 6 clusters size under this method.

    X = wine[,(1:11)]
    X = scale(X, center=TRUE, scale=TRUE)

    mu = attr(X,"scaled:center")
    sigma = attr(X,"scaled:scale")
    distance_between_wines = dist(X, method='euclidean')
    hier_wine = hclust(distance_between_wines, method='average')
    cluster3 = cutree(hier_wine, k=6)
    summary(factor(cluster3))

    ##    1    2    3    4    5    6 
    ## 6462    6   25    2    1    1

##### distinguish quality

In this case, I set 6 clusters, for each color it has 3 level quality,
and we create plots to show that different clusters with different
qualies

![](HW4_1_files/figure-markdown_strict/cluster3%20plots-1.png)![](HW4_1_files/figure-markdown_strict/cluster3%20plots-2.png)![](HW4_1_files/figure-markdown_strict/cluster3%20plots-3.png)

from the table we can see that almost each quality level contain
different clusters, is is not as obvious as we can distinguish the color
previously. On the other hand, we can see that the size of cluster
affect its distribution, since larger size, larger distribution.

#### PCA model

Then we use the same variables as used in clustering models, and try to
do some unsupervised calculation.

##### Estimating quality

we use four PCA variables to describe initial 11 indexes.

and we can get each variable’s description
![](HW4_1_files/figure-markdown_strict/PCA%20variables%20descriptions-1.png)

    ## Importance of first k=4 (out of 11) components:
    ##                           PC1    PC2    PC3     PC4
    ## Standard deviation     1.7407 1.5792 1.2475 0.98517
    ## Proportion of Variance 0.2754 0.2267 0.1415 0.08823
    ## Cumulative Proportion  0.2754 0.5021 0.6436 0.73187

we can get create a tidy summary of the loadings:

<table>
<caption>loading summary table</caption>
<thead>
<tr class="header">
<th style="text-align: left;">index</th>
<th style="text-align: right;">PC1</th>
<th style="text-align: right;">PC2</th>
<th style="text-align: right;">PC3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fixed.acidity</td>
<td style="text-align: right;">-0.2387989</td>
<td style="text-align: right;">0.3363545</td>
<td style="text-align: right;">-0.4343013</td>
</tr>
<tr class="even">
<td style="text-align: left;">volatile.acidity</td>
<td style="text-align: right;">-0.3807575</td>
<td style="text-align: right;">0.1175497</td>
<td style="text-align: right;">0.3072594</td>
</tr>
<tr class="odd">
<td style="text-align: left;">citric.acid</td>
<td style="text-align: right;">0.1523884</td>
<td style="text-align: right;">0.1832994</td>
<td style="text-align: right;">-0.5905697</td>
</tr>
<tr class="even">
<td style="text-align: left;">residual.sugar</td>
<td style="text-align: right;">0.3459199</td>
<td style="text-align: right;">0.3299142</td>
<td style="text-align: right;">0.1646884</td>
</tr>
<tr class="odd">
<td style="text-align: left;">chlorides</td>
<td style="text-align: right;">-0.2901126</td>
<td style="text-align: right;">0.3152580</td>
<td style="text-align: right;">0.0166791</td>
</tr>
<tr class="even">
<td style="text-align: left;">free.sulfur.dioxide</td>
<td style="text-align: right;">0.4309140</td>
<td style="text-align: right;">0.0719326</td>
<td style="text-align: right;">0.1342239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total.sulfur.dioxide</td>
<td style="text-align: right;">0.4874181</td>
<td style="text-align: right;">0.0872663</td>
<td style="text-align: right;">0.1074623</td>
</tr>
<tr class="even">
<td style="text-align: left;">density</td>
<td style="text-align: right;">-0.0449366</td>
<td style="text-align: right;">0.5840373</td>
<td style="text-align: right;">0.1756056</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pH</td>
<td style="text-align: right;">-0.2186864</td>
<td style="text-align: right;">-0.1558690</td>
<td style="text-align: right;">0.4553241</td>
</tr>
<tr class="even">
<td style="text-align: left;">sulphates</td>
<td style="text-align: right;">-0.2941352</td>
<td style="text-align: right;">0.1917158</td>
<td style="text-align: right;">-0.0700425</td>
</tr>
<tr class="odd">
<td style="text-align: left;">alcohol</td>
<td style="text-align: right;">-0.1064371</td>
<td style="text-align: right;">-0.4650577</td>
<td style="text-align: right;">-0.2611005</td>
</tr>
</tbody>
</table>

loading summary table

Then we can predict quality with PCA summaries
